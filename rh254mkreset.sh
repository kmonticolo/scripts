#!/bin/bash# kmonticolo 16.01.17num=`hostname -s|grep -o '.$'`if [ -z ${num} ]; then  echo "please provide number of your workstation."  exit 1fimkdir -p ~/bincat > ~/bin/reset.sh <<EOT#!/bin/shecho "Reset desktop and server, wait 30 s."echo y|rht-vmctl reset desktop >/dev/null 2>&1 ||exit 1echo y|rht-vmctl reset server  >/dev/null 2>&1 ||exit 2~/bin/keys.sh#ssh root@d${num} "rpm -ivh https://yum.puppetlabs.com/puppetlabs-release-el-7.noarch.rpm; yum install -y facter"exit 0EOTcat > ~/bin/keys.sh <<EOT#!/bin/shrpm --quiet -q epel-release || sudo yum -y install https://dl.fedoraproject.org/pub/epel/epel-release-latest-7.noarch.rpmwhich sshpass >/dev/null || sudo yum install -y sshpasssshpass -p 'redhat' ssh-copy-id root@s${num} >/dev/null 2>&1 && echo "type \"s\" to login to server${num}"sshpass -p 'redhat' ssh-copy-id root@d${num} >/dev/null 2>&1 && echo "type \"d to login to desktop${num}"EOTchmod +x ~/bin/*shf=~/.bashrctouch ~/.bashrcgrep -q ^.*PATH=.*~/bin ~/.bashrc || echo "export PATH=$PATH:~/bin" >> $fgrep -qw "alias s${num}=" ${f} || echo "alias s${num}=\"ssh root@s${num}\"" >> ${f}grep -qw "alias d${num}=" ${f} || echo "alias d${num}=\"ssh root@d${num}\"" >> ${f}grep -qw "alias s=" ${f} || echo "alias s=\"ssh root@s${num}\"" >> ${f}grep -qw "alias d=" ${f} || echo "alias d=\"ssh root@d${num}\"" >> ${f}grep -qw "alias c=" ${f} || echo "alias c=\"ssh root@d${num}\"" >> ${f}echo "type: source $f"echo "then type reset.sh to reset both server${num} and desktop${num}"echo "type \"s\" to login to server${num}, or \"d\" to login to desktop${num} without using passwords."
